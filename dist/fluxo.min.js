/*! fluxo-js v0.0.17 | (c) 2014, 2015 Samuel Sim√µes | https://github.com/fluxo-js/fluxo */
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.Fluxo=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var h=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},i=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),j=function(a,b,c){for(var d=!0;d;){var e=a,f=b,g=c;d=!1,null===e&&(e=Function.prototype);var h=Object.getOwnPropertyDescriptor(e,f);if(void 0!==h){if("value"in h)return h.value;var i=h.get;return void 0===i?void 0:i.call(g)}var j=Object.getPrototypeOf(e);if(null===j)return void 0;a=j,b=f,c=g,d=!0,h=j=void 0}},k=a("./fluxo.object_store.js"),l=d(k),m=function(a){function b(){var a=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],c=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];f(this,b),j(Object.getPrototypeOf(b.prototype),"constructor",this).call(this,c),this.store=this.constructor.store||l["default"],this.stores=[],this.storesOnChangeCancelers={},this.subsets={},this.subset=this.constructor.subset||{},this.childrenDelegate=this.constructor.childrenDelegate||[],this.setStores(a),this.registerSubsets(),this.createDelegateMethods()}return g(b,a),i(b,[{key:"getSubset",value:function(a){if(!this[a])throw new Error('Subset compute function to "'+a+'" subset is not defined.');var c=this[a].call(this);return new b(c)}},{key:"updateSubset",value:function(a){var c=this.subset[a];c instanceof b&&c.removeAll(),this.subsets[a]=this.getSubset(a),this.triggerEvents(["change","change:"+a])}},{key:"registerSubsets",value:function(){for(var a in this.subset){var b=["add","remove"].concat(e(this.subset[a]));this.on(b,this.updateSubset.bind(this,a)),this.updateSubset(a)}}},{key:"createDelegateMethods",value:function(){for(var a=0,b=this.childrenDelegate.length;b>a;a++){var c=this.childrenDelegate[a];this.createDelegateMethod(c)}}},{key:"createDelegateMethod",value:function(a){this[a]=function(a,b){for(var c=this.find(b),d=arguments.length,e=Array(d>2?d-2:0),f=2;d>f;f++)e[f-2]=arguments[f];c[a].apply(c,e)}.bind(this,a)}},{key:"addStores",value:function(a){for(var b=0,c=a.length;c>b;b++){var d=a[b];this.addStore(d)}}},{key:"resetStores",value:function(a){this.removeAll(),this.addStores(a)}},{key:"removeAll",value:function(){for(var a=this.stores.length-1,b=0;a>=b;a--){var c=this.stores[a];this.removeListenersOn(c)}this.stores=[],this.triggerEvents(["remove","change"])}},{key:"setStores",value:function(a){for(var b=0,c=a.length;c>b;b++){var d=a[b],e=this.find(d.id||d.cid);e?e.set(d):this.addStore(d)}}},{key:"addStore",value:function(a){a instanceof this.store||(a=new this.store(a));var b=this.find(a.data.id);if(b)return b;this.stores.push(a);var c=function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];this.triggerEvent.apply(this,["stores:"+a].concat(c))};return this.storesOnChangeCancelers[a.cid]=a.on(["*"],c.bind(this)),this.sort&&this.stores.sort(this.sort),this.triggerEvents(["add","change"]),a}},{key:"find",value:function(a){var b;return a&&(b=this.findWhere({id:a}),b||this.stores.some(function(c){return c.cid===a?(b=c,!0):void 0})),b}},{key:"findWhere",value:function(a){return this.where(a,!0)[0]}},{key:"where",value:function(a,b){var c=[];if(!a)return[];for(var d=0,e=this.stores.length;e>d;d++){var f=this.stores[d],g=!0;for(var h in a)if(f.data[h]!==a[h]){g=!1;break}if(g&&(c.push(f),b))break}return c}},{key:"removeListenersOn",value:function(a){this.storesOnChangeCancelers[a.cid].call(),delete this.storesOnChangeCancelers[a.cid]}},{key:"remove",value:function(a){this.removeListenersOn(a),this.stores.splice(this.stores.indexOf(a),1),this.triggerEvents(["remove","change"])}},{key:"storesToJSON",value:function(){for(var a=[],b=0,c=this.stores.length;c>b;b++){var d=this.stores[b];a.push(d.toJSON())}return a}},{key:"subsetsToJSON",value:function(){var a={};for(var b in this.subsets)a[b]=this.subsets[b].toJSON().stores;return a}},{key:"toJSON",value:function(){return h({data:j(Object.getPrototypeOf(b.prototype),"toJSON",this).call(this),stores:this.storesToJSON()},this.subsetsToJSON())}}]),b}(l["default"]);c["default"]=m,b.exports=c["default"]},{"./fluxo.object_store.js":4}],2:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c["default"]=function(){for(var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];for(var e=0,f=c.length;f>e;e++){var g=c[e];for(var h in g)a[h]=g[h]}return a},b.exports=c["default"]},{}],3:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(c,"__esModule",{value:!0});var e=a("./fluxo.object_store.js"),f=d(e),g=a("./fluxo.collection_store.js"),h=d(g),i=a("./fluxo.extend.js"),j=d(i),k=a("./fluxo.radio.js"),l=d(k);c["default"]={ObjectStore:f["default"],CollectionStore:h["default"],Extend:j["default"],Radio:l["default"]},b.exports=c["default"]},{"./fluxo.collection_store.js":1,"./fluxo.extend.js":2,"./fluxo.object_store.js":4,"./fluxo.radio.js":5}],4:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(c,"__esModule",{value:!0});var f=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=a("./fluxo.radio.js"),i=d(h),j=a("./fluxo.extend.js"),k=(d(j),1),l=function(){function a(){var b=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];e(this,a),this.cid="FS:"+k++,this.data={},this.computed=this.constructor.computed||{},this.attributeParsers=this.constructor.attributeParsers||{},this.set(f({},this.constructor.defaults,b)),this.registerComputed()}return g(a,[{key:"on",value:function(a,b){for(var c=[],d=0,e=a.length;e>d;d++){var f=a[d],g=this.cid+":"+f,h=i["default"].subscribe(g,b.bind(this));c.push(h)}var j=function(){for(var a=0,b=c.length;b>a;a++){var d=c[a];d.call()}};return j}},{key:"triggerEvents",value:function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];for(var e=0,f=a.length;f>e;e++){var g=a[e];this.triggerEvent.apply(this,[g].concat(c))}}},{key:"triggerEvent",value:function(a){for(var b=this.cid+":"+a,c=arguments.length,d=Array(c>1?c-1:0),e=1;c>e;e++)d[e-1]=arguments[e];i["default"].publish.apply(i["default"],[b,this].concat(d)),i["default"].publish.apply(i["default"],[this.cid+":*",a,this].concat(d))}},{key:"getComputed",value:function(a){if(!this[a])throw new Error('Compute function to "'+a+'" value is not defined.');return this[a].call(this)}},{key:"computeValue",value:function(a){this.setAttribute(a,this.getComputed(a))}},{key:"registerComputed",value:function(){for(var a in this.computed){var b=this.computed[a];this.on(b,this.computeValue.bind(this,a)),this.setAttribute(a,this.getComputed(a))}}},{key:"setAttribute",value:function(a,b,c){c=c||{},this.data[a]!==b&&(this.attributeParsers[a]&&(b=this.attributeParsers[a](b)),this.data[a]=b,this.triggerEvent("change:"+a),c.silentGlobalChange||this.triggerEvent("change"))}},{key:"unsetAttribute",value:function(a,b){b=b||{},delete this.data[a],this.triggerEvent("change:"+a),b.silentGlobalChange||this.triggerEvent("change")}},{key:"set",value:function(a){for(var b in a)this.setAttribute(b,a[b],{silentGlobalChange:!0});this.triggerEvent("change")}},{key:"reset",value:function(a){a=a||{};for(var b in this.data)void 0===a[b]&&this.unsetAttribute(b,{silentGlobalChange:!0});for(var b in a)this.setAttribute(b,a[b],{silentGlobalChange:!0});this.triggerEvent("change")}},{key:"toJSON",value:function(){var a=JSON.parse(JSON.stringify(this.data));return a.cid=this.cid,a}}]),a}();c["default"]=l,b.exports=c["default"]},{"./fluxo.extend.js":2,"./fluxo.radio.js":5}],5:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c["default"]={callbackIds:1,events:{},subscribe:function(a,b){var c=this.callbackIds++;return this.events[a]=this.events[a]||{},this.events[a][c]=b,this.removeSubscription.bind(this,a,c)},removeSubscription:function(a,b){this.events[a]=this.events[a]||{},delete this.events[a][b]},publish:function(a){for(var b=this.events[a]||{},c=arguments.length,d=Array(c>1?c-1:0),e=1;c>e;e++)d[e-1]=arguments[e];for(var f in b)b[f].apply(null,d)}},b.exports=c["default"]},{}]},{},[3])(3)});
//# sourceMappingURL=fluxo.map