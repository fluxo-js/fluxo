/*! fluxo v0.0.1 | (c) 2014, 2015 Samuel SimÃµes |  */
!function(a,b){if("function"==typeof define&&define.amd)define([],b);else{if("undefined"!=typeof exports)return module.exports=b();a.Fluxo=b()}}(this,function(){var a={};a.extend=function(a){a=a||{};for(var b=Array.prototype.slice.call(arguments,1),c=0,d=b.length;d>c;c++){var e=b[c];for(var f in e)a[f]=e[f]}return a};var b=function(b){var c=this,d=function(){return c.apply(this,arguments)};return a.extend(d,this),a.extend(this.prototype,b),a.extend(d.prototype,this.prototype),d};return a.Radio={callbackIds:1,events:{},subscribe:function(a,b){var c=this.callbackIds+1;return this.events[a]=this.events[a]||{},this.events[a][c]=b,this.removeSubscription.bind(this,a,c)},removeSubscription:function(a,b){this.events[a]=this.events[a]||{},delete this.events[a][b]},publish:function(a){var b=this.events[a]||{};for(var c in b)b[c].apply(null,Array.prototype.slice.call(arguments,1))}},a.Mixin=function(a){for(var b=Array.prototype.slice.call(arguments,1),c=function(b,c){var d=a[b];a[b]=function(){var b=Array.prototype.slice.call(arguments);return c.apply(a,b),d.apply(a,b)}},d=function(b){for(var d in b){var e=b[d];a.hasOwnProperty(d)&&"function"==typeof e?c(d,e):"function"==typeof e?a[d]=e.bind(a):a[d]=e}},e=0,f=b.length;f>e;e++){var g=b[e];d(g)}},a.Store=function(b,c){b&&(b=JSON.parse(JSON.stringify(b))),this.data=b||{},this.options=c||{},this.changeEventToken=Math.random().toString().slice(2,11),a.Mixin.apply(null,[Object.getPrototypeOf(this)].concat(this.mixins)),this.initialize(b,c)},a.Store.extend=b,a.Store.prototype={initialize:function(){},mixins:[],toJSON:function(){return this.data},setAttribute:function(a,b){this.data[a]=b,this.emitChange()},set:function(b){a.extend(this.data,b),this.emitChange()},onChange:function(b){return a.Radio.subscribe(this.changeEventToken,b.bind(this))},emitChange:function(){a.Radio.publish(this.changeEventToken,this.toJSON())}},a.CollectionStore=function(b,c){b=b?JSON.parse(JSON.stringify(b)):[],this.changeEventToken=Math.random().toString().slice(2,11),this.stores=[],this.options=c||{};for(var d=0,e=b.length;e>d;d++)this.addFromData(b[d]);a.Mixin.apply(null,[Object.getPrototypeOf(this)].concat(this.mixins)),this.initialize(b,c)},a.CollectionStore.extend=b,a.CollectionStore.prototype={initialize:function(){},mixins:[],store:a.Store,storesOnChangeCancelers:{},addFromData:function(a){var b=new this.store(a);this.addStore(b)},addStore:function(a){this.storeAlreadyAdded(a)||(this.stores.push(a),this.storesOnChangeCancelers[a.changeEventToken]=a.onChange(this.emitChange.bind(this)),this.emitChange())},find:function(a){var b;if(a){for(var c=0,d=this.stores.length;d>c;c++){var e=this.stores[c].data.id;if(e&&e==a){b=this.stores[c];break}}return b}},storeAlreadyAdded:function(a){return this.find(a.data.id)},onChange:function(b){return a.Radio.subscribe(this.changeEventToken,b.bind(this))},remove:function(a){this.storesOnChangeCancelers[a.changeEventToken](),delete this.storesOnChangeCancelers[a.changeEventToken],this.stores.splice(this.stores.indexOf(a),1),this.emitChange()},emitChange:function(){a.Radio.publish(this.changeEventToken)},toJSON:function(){for(var a=[],b=0,c=this.stores.length;c>b;b++){var d=this.stores[b];a.push(d.toJSON())}return a}},a.actionHandlers={},a.registerActionHandler=function(b,c){a.actionHandlers[b]=c;var d=Array.prototype.slice.call(arguments,2);"function"==typeof c.initialize&&c.initialize.apply(c,d)},a.callAction=function(b,c){var d=a.actionHandlers[b];if(!d)throw new Error("Action handler "+b+" not found.");var e=d[c];if(!e)throw new Error("Action "+c+" not found on "+b+" handler.");var f=Array.prototype.slice.call(arguments,2);return e.apply(d,f)},a.WatchComponent={storesOnChangeCancelers:[],getInitialState:function(){for(var a={},b=0,c=this.listenProps.length;c>b;b++){var d=this.listenProps[b],e=this.props[d];a[d]=e.toJSON()}return a},componentWillMount:function(){for(var a=0,b=this.listenProps.length;b>a;a++){var c=this.listenProps[a],d=this.props[c];this.listenStore(d)}},listenStore:function(a){var b=a.onChange(function(){var b={};b[storeIdentifierProp]=a.toJSON(),this.setState(b)}.bind(this));this.storesOnChangeCancelers.push(b)},componentWillUnmount:function(){for(var a=0,b=this.storesOnChangeCancelers.length;b>a;a++)this.storesOnChangeCancelers[a].apply()}},a});
//# sourceMappingURL=fluxo.map